/* ================================
   Circuit City â€“ Polish v3.1 (safe)
   Layered on top of app.css/tokens.css
   Only tweaks existing classes + adds utilities.
   ================================ */

/* ---------- Theme tokens (non-destructive) ---------- */
:root{
  /* Base (fall back to existing cc tokens if present) */
  --p-bg:            var(--cc-bg, #f6f7fb);
  --p-surface:       var(--cc-card, #ffffff);
  --p-surface-2:     #f8fafc;
  --p-border:        var(--cc-border, #e5e7eb);
  --p-text:          var(--cc-text, #0f172a);
  --p-muted:         var(--cc-muted, #64748b);
  --p-brand:         var(--cc-brand, #2563eb);
  --p-brand-600:     var(--cc-brand-dark, #1d4ed8);
  --p-ok:            var(--cc-ok, #10b981);
  --p-ok-700:        var(--cc-ok-dark, #059669);
  --p-danger:        var(--cc-danger, #ef4444);
  --p-radius:        14px;
  --p-shadow:        0 10px 24px rgba(2,6,23,.08), 0 2px 6px rgba(2,6,23,.06);
  --p-ring:          0 0 0 3px rgba(37,99,235,.25);
  --p-blur:          saturate(1.15) blur(6px);
  /* Type scale */
  --t-xs:12px; --t-sm:13px; --t-base:clamp(14px, 1.6vw, 16px);
  --t-md:clamp(16px, 1.8vw, 18px); --t-lg:clamp(20px, 2.6vw, 26px);
  --t-xl:clamp(28px, 4.2vw, 40px); --t-2xl:clamp(36px, 6vw, 56px);
}

/* Dark theme refinements (keeps your existing switch) */
:root[data-theme="dark"]{
  --p-bg:        #0b1220;
  --p-surface:   #0e1629;
  --p-surface-2: #0f1b33;
  --p-border:    #20324d;
  --p-text:      #e5e7eb;
  --p-muted:     #a8b3cf;
  --p-brand:     #76a9ff;
  --p-brand-600: #5e90ef;
  --p-ok:        #34d399;
  --p-ok-700:    #10b981;
  --p-danger:    #f87171;
  --p-shadow:    0 10px 28px rgba(0,0,0,.35), 0 2px 6px rgba(0,0,0,.25);
}

/* Subtle gradient background in dark for depth */
html[data-theme="dark"] body.cc-body{
  background: radial-gradient(120% 120% at 0% 0%, #0b1220 0%, #0a0f1d 55%, #070b15 100%);
}
body.cc-body{ font-size: var(--t-base); }

/* ---------- Top nav polish ---------- */
.cc-topnav{
  backdrop-filter: var(--p-blur);
  background: color-mix(in oklab, var(--p-surface) 86%, transparent);
  border-bottom: 1px solid var(--p-border);
  box-shadow: 0 2px 12px rgba(2,6,23,.04);
}
.cc-brand{ font-weight: 800; }

/* --- Make ALL header/quick-action buttons look consistent --- */
.cc-topnav .btn,
.cc-toolbar .actions .btn,
.cc-quick-actions .btn{
  /* unified chip look */
  height: 42px;
  display: inline-flex; align-items: center; gap: 8px;
  padding: 0 14px;
  border-radius: 12px;
  box-shadow: var(--p-shadow);
  border: 1px solid var(--p-border);
  background: var(--p-surface);
  color: var(--p-text);
  transition: transform .06s ease, filter .2s ease, box-shadow .2s ease;
}
.cc-topnav .btn:hover,
.cc-toolbar .actions .btn:hover{ filter: brightness(1.02); }
.cc-topnav .btn:active,
.cc-toolbar .actions .btn:active{ transform: translateY(1px) scale(.99); }
.cc-topnav .btn:focus-visible,
.cc-toolbar .actions .btn:focus-visible{ box-shadow: var(--p-ring), var(--p-shadow); outline: none; }

/* Emphasis variants where present */
.cc-topnav .btn-primary,
.cc-toolbar .actions .btn-primary,
.cc-topnav .btn-sky{
  border: 0;
  color:#fff !important;
  background: linear-gradient(90deg, var(--p-brand), var(--p-brand-600));
}
.cc-topnav .btn-green,
.cc-toolbar .actions .btn-green{
  border: 0;
  color:#052b1b !important;
  background: linear-gradient(90deg, var(--p-ok), var(--p-ok-700));
}

/* Legacy header chip class support */
.cc-topbtn.btn{
  border: 0;
  color:#fff;
  background: linear-gradient(90deg, var(--p-brand), var(--p-brand-600));
  box-shadow: var(--p-shadow);
}
.cc-topbtn.btn:hover{ filter: brightness(.96); }

/* Theme toggle chip */
.cc-theme-toggle{ border: 1px solid var(--p-border); background: var(--p-surface); }

/* ---------- Sidebar polish ---------- */
.cc-sidebar{
  background: var(--p-surface);
  border-right: 1px solid var(--p-border);
}
.cc-sidebar-group{ color: var(--p-muted); font-weight: 700; letter-spacing: .06em; }
.cc-sideitem{
  color: var(--p-text);
  border-radius: 10px;
}
.cc-sideitem:hover{ background: color-mix(in oklab, var(--p-surface-2) 90%, transparent); }
.cc-sideitem.active{
  background: color-mix(in oklab, var(--p-brand) 14%, transparent);
  border: 1px solid color-mix(in oklab, var(--p-brand) 26%, var(--p-border));
  color: var(--p-text);
}

/* Mobile off-canvas shadow */
@media (max-width:1024px){
  .cc-sidebar{ box-shadow: 0 20px 60px rgba(2,6,23,.18); }
}

/* ---------- Cards / panels ---------- */
.card, .cc-panel{
  background: var(--p-surface);
  border: 1px solid var(--p-border);
  border-radius: var(--p-radius);
  box-shadow: var(--p-shadow);
}
.card-header{ color: var(--p-muted); font-weight: 700; }

/* KPI tiles */
.kpi{
  display:grid; gap:6px; padding:14px;
  background: color-mix(in oklab, var(--p-surface-2) 85%, var(--p-surface));
  border:1px solid var(--p-border); border-radius: 12px;
}
.kpi .label{ color: var(--p-muted); font-size: var(--t-sm); font-weight: 700; }
.kpi .value{ font-size: var(--t-xl); font-weight: 900; letter-spacing:.01em; }
.kpi.up .value{ color: var(--p-ok); }
.kpi.down .value{ color: var(--p-danger); }

/* ---------- Buttons (global) ---------- */
.btn{
  background: var(--p-surface-2);
  color: var(--p-text);
  border: 1px solid var(--p-border);
  border-radius: 12px;
  box-shadow: var(--p-shadow);
  transition: transform .06s ease, filter .2s ease, box-shadow .2s ease;
}
.btn:hover{ filter: brightness(.98); }
.btn:active{ transform: translateY(1px) scale(.99); }
.btn:focus-visible{ box-shadow: var(--p-ring), var(--p-shadow); outline: none; }
.btn-primary{
  background: linear-gradient(180deg, color-mix(in oklab, var(--p-brand) 90%, white) 0%, var(--p-brand) 45%, var(--p-brand-600) 100%);
  color:#fff; border:0;
}

/* Subtle ghost */
.btn-ghost{ background: transparent; border:1px solid var(--p-border); }
.btn-ghost:hover{ background: color-mix(in oklab, var(--p-surface-2) 80%, transparent); }

/* Mobile-friendly */
@media (max-width:640px){
  .btn, .cc-topbtn.btn{ min-height:44px; padding:.65rem .9rem; }
  .btn-block{ width:100% }
}

/* ---------- Forms ---------- */
.input, .select, .textarea{
  background: var(--p-surface);
  color: var(--p-text);
  border: 1px solid var(--p-border);
  border-radius: 12px;
  padding: 12px 14px;
  font-size: 16px; /* prevent iOS zoom */
  transition: border-color .15s ease, box-shadow .2s ease;
}
.input::placeholder{ color: color-mix(in oklab, var(--p-muted) 85%, #9aa4b2); }
.input:focus, .select:focus, .textarea:focus{
  outline: none; box-shadow: var(--p-ring);
  border-color: color-mix(in oklab, var(--p-brand) 55%, var(--p-border));
}

/* Inline field with trailing action */
.field{ display:flex; align-items:center; gap:10px; }

/* --- Dark-mode fix for Scan IN / Scan SOLD inline backgrounds --- */
:root[data-theme="dark"] .field,
:root[data-theme="dark"] .field > input,
:root[data-theme="dark"] .field > select,
:root[data-theme="dark"] .field > .form-control{
  background: var(--p-surface) !important;
  color: var(--p-text) !important;
  border-color: var(--p-border) !important;
}

/* ---------- Tables ---------- */
.table-wrap{ width:100%; overflow-x:auto; -webkit-overflow-scrolling:touch; }
.table{
  width:100%; border-collapse:separate; border-spacing:0;
  background: color-mix(in oklab, var(--p-surface-2) 85%, var(--p-surface));
  border:1px solid var(--p-border); border-radius: 12px; overflow: hidden;
  font-size: var(--t-sm);
}
.table th, .table td{ padding:12px 14px; border-bottom:1px solid var(--p-border); }
.table thead th{
  position: sticky; top: 0; z-index: 1;
  background: color-mix(in oklab, var(--p-surface) 92%, transparent);
  backdrop-filter: var(--p-blur);
  color: var(--p-muted); font-weight: 800; text-align:left;
}
.table tbody tr:hover td{ background: color-mix(in oklab, var(--p-surface-2) 80%, transparent); }

/* ---------- Alerts / toasts ---------- */
.cc-alert{
  border-radius: 12px;
  border: 1px solid var(--p-border);
  box-shadow: var(--p-shadow);
}
.toast{
  position: fixed; right: 16px; bottom: 16px; z-index: 60;
  display: grid; gap: 10px;
}
.toast-item{
  background: color-mix(in oklab, var(--p-surface) 92%, transparent);
  border: 1px solid var(--p-border);
  color: var(--p-text);
  border-radius: 12px; padding: 10px 14px; box-shadow: var(--p-shadow);
}

/* ---------- Charts ---------- */
.cc-chart-wrap{ background: var(--p-surface); border:1px solid var(--p-border); border-radius:12px; padding:8px; }
.cc-chart{ height: 260px !important; }

/* ---------- Mobile Tab Bar (optional) ---------- */
.tabbar{
  position: sticky; bottom: 0; left: 0; right: 0; z-index: 40;
  backdrop-filter: var(--p-blur);
  background: color-mix(in oklab, var(--p-surface) 86%, transparent);
  border-top: 1px solid var(--p-border);
}
.tabbar ul{ display:flex; gap:8px; list-style:none; margin:0; padding:8px; }
.tabbar a{
  flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:4px; padding:8px 6px; text-decoration:none;
  color: var(--p-muted); font-weight:700; font-size:12px; border-radius: 10px;
}
.tabbar a[aria-current="page"]{ color: var(--p-text); background: color-mix(in oklab, var(--p-surface-2) 80%, transparent); }
@media (min-width:1025px){ .tabbar{ display:none } }

/* ---------- Utilities ---------- */
.elevate{ box-shadow: var(--p-shadow); }
.round{ border-radius: var(--p-radius); }
.muted{ color: var(--p-muted); }
.badge{ padding:6px 10px; border-radius:999px; font-weight:700; font-size:12px; background: var(--p-surface-2); border:1px solid var(--p-border); }
.badge--ok{ color: var(--p-ok); border-color: color-mix(in oklab, var(--p-ok) 40%, var(--p-border)); }
.badge--danger{ color: var(--p-danger); border-color: color-mix(in oklab, var(--p-danger) 40%, var(--p-border)); }

.actions-row{ display:flex; align-items:center; gap:.5rem; }

/* Focus visibility */
:focus-visible{ outline: none; box-shadow: var(--p-ring) !important; border-radius: .4rem; }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .btn, .cc-sidebar{ transition: none !important; }
}

/* =====================================================
   Additions for perfect mobile fit + premium nav
   (non-destructive; safe to keep at the end)
   ===================================================== */

/* Prevent horizontal scroll and make width snug on phones */
html, body{ max-width:100%; overflow-x:hidden; }

/* Page container sizing (used by dashboard/list headers) */
.cc-page{ max-width:1100px; width:100%; margin-inline:auto; padding-inline:12px; }

/* Header spacing trimmed to remove blank gap */
.cc-header{ padding-block:8px; }

/* Responsive toolbar: brand | actions; stacks on mobile */
.cc-toolbar{
  display:grid; grid-template-columns:1fr auto;
  align-items:center; gap:10px;
}
.cc-toolbar .brand{ display:flex; align-items:center; gap:10px; min-width:0; }
.cc-toolbar .actions{ display:flex; flex-wrap:wrap; gap:10px; justify-content:flex-end; }
@media (max-width:640px){
  .cc-toolbar{ grid-template-columns:1fr; }
  .cc-toolbar .actions{ justify-content:flex-start; }
}

/* Menu button chip */
.cc-menu-btn{
  width:42px; height:42px; border-radius:12px;
  display:grid; place-items:center;
  border:1px solid var(--p-border);
  background: var(--p-surface);
  box-shadow: var(--p-shadow);
}
:root[data-theme="dark"] .cc-menu-btn{ background: var(--p-surface-2); }

/* Quick actions container */
.cc-quick-actions{ display:flex; flex-wrap:wrap; gap:10px; }

/* Premium quick-link pills (replace plain text links) */
.crumbs{
  display:flex; flex-wrap:wrap; gap:10px;
  margin-top:16px;
}
.crumbs a{
  display:inline-flex; align-items:center; gap:8px;
  padding:10px 14px; border-radius:999px;
  text-decoration:none; font-weight:700;
  background: var(--p-surface); color: var(--p-text);
  border:1px solid var(--p-border); box-shadow: var(--p-shadow);
  transition:transform .12s ease, filter .2s ease;
}
.crumbs a:hover{ transform:translateY(-1px); filter:brightness(1.03); }

/* --- Minor niceties --- */
.kbd{
  font-family: ui-monospace, Menlo, Consolas, monospace;
  background: var(--p-surface-2);
  border: 1px solid var(--p-border);
  color: var(--p-text);
  padding: 2px 6px; border-radius: 6px;
}
