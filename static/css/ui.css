/* ==========================================================================
   Circuit City UI — components + utilities
   (drop-in stylesheet)
   Works with static/css/tokens.css (design tokens + themes)
   ========================================================================== */

/* ===== Theme aliases (prefer tokens → cc-* → local defaults) ===== */
:root{
  /* Colors (wired to tokens.css single source of truth) */
  --theme-bg:        var(--bg,        var(--cc-bg, #0b1220));
  --theme-fg:        var(--fg,        var(--cc-text, #e6ecfb));
  --theme-fg-muted:  var(--fg-muted,  var(--cc-muted, #9fb0cf));

  /* ALL primary CTAs must use the Forgot-Password blue */
  --theme-brand:     var(--brand,     var(--cc-accent, #2563eb));  /* blue-500 */
  --theme-brand-2:   var(--brand-2,   var(--cc-accent-2, #1d4ed8));/* blue-600 hover */

  --theme-border:    var(--border,    var(--cc-border, rgba(148,163,184,.22)));
  --theme-card:      var(--card,      var(--cc-panel, rgba(255,255,255,.06)));
  --theme-surface:   var(--surface,   var(--cc-panel-2, rgba(255,255,255,.10)));

  /* Icon standard (green) */
  --icon-green: var(--icon-green, #16a34a);

  /* Radii / shadows / sizes */
  --radius:     var(--radius, 12px);
  --radius-sm:  var(--radius-sm, 10px);
  --shadow-sm:  var(--shadow-sm, 0 2px 10px rgba(0,0,0,.08));
  --shadow-md:  var(--shadow-md, 0 8px 24px rgba(0,0,0,.12));

  --gap-1:.5rem; --gap-2:.75rem; --gap-3:1rem; --gap-4:1.25rem; --gap-5:1.5rem;

  --navbar-bg:  var(--navbar-bg, color-mix(in oklab, var(--theme-card) 85%, transparent));
  --success:    var(--success, #16a34a);
  --warning:    var(--warning, #d97706);
  --danger:     var(--danger,  #dc2626);

  --control-h:  var(--control-h, 44px);
  --card-pad:   var(--card-pad, 16px);

  /* Charts */
  --chart-h:    var(--chart-h, 260px);
  --chart-h-sm: var(--chart-h-sm, 200px);
  --chart-grid: var(--chart-grid, rgba(148,163,184,.25));

  /* Layout width */
  --container-w: 1120px;

  /* Microinteractions */
  --elev-hover: 0 12px 30px rgba(0,0,0,.18);
  --ring-brand: 0 0 0 3px color-mix(in oklab, var(--theme-brand) 35%, transparent);
}

/* ===== Base ===== */
*{box-sizing:border-box}
html,body{height:100%}
html,body{overflow-x:hidden}
*{
  transition:
    background-color .25s linear,
    color .25s linear,
    border-color .25s linear,
    box-shadow .25s linear,
    transform .15s ease;
}
body{
  margin:0;
  background:var(--theme-bg);
  color:var(--theme-fg);
  /* Stock List font = app-wide standard */
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans";
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
}
a{color:var(--theme-brand); text-decoration:none}
a:hover{text-decoration:underline}

/* ===== Layout helpers ===== */
.page{margin:0 auto; max-width:var(--container-w); padding:clamp(12px,4vw,24px)}
.vstack{display:flex; flex-direction:column; gap:var(--gap-2)}
.hstack{display:flex; align-items:center; gap:var(--gap-2); flex-wrap:wrap}
.grid{display:grid; gap:var(--gap-3)}
.grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
.grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
@media (max-width:900px){ .grid.cols-2,.grid.cols-3{grid-template-columns:1fr} }

.equal-row{ display:flex; gap:var(--gap-3); align-items:stretch; flex-wrap:wrap }
.equal-row > *{ flex:1 1 0; min-width:280px }
.h-100{ height:100% }

.mt-1{margin-top:.5rem} .mt-2{margin-top:1rem} .mt-3{margin-top:1.5rem}
.mb-1{margin-bottom:.5rem} .mb-2{margin-bottom:1rem} .mb-3{margin-bottom:1.5rem}
.p-1{padding:.5rem} .p-2{padding:1rem} .p-3{padding:1.5rem}

/* ===== Navbar ===== */
.navbar{
  position:sticky; top:0; z-index:50;
  background:var(--navbar-bg);
  border-bottom:1px solid var(--theme-border);
  backdrop-filter:none; -webkit-backdrop-filter:none;
}
@supports (backdrop-filter: blur(6px)){
  .navbar{backdrop-filter:blur(6px); -webkit-backdrop-filter:blur(6px)}
}
.navbar-inner{
  max-width:var(--container-w); margin:0 auto; padding:.6rem 1rem;
  display:flex; align-items:center; justify-content:space-between
}
.brand{font-weight:700; letter-spacing:.2px}
.nav-actions{display:flex; gap:.5rem}

/* ==========================================================================
   CARDS / TILES / KPI
   ========================================================================== */
.card{
  background:var(--theme-card);
  border:1px solid var(--theme-border);
  border-radius:var(--radius);
  box-shadow:var(--shadow-md);
  padding:var(--card-pad);
  will-change: transform, box-shadow;
}
.card.soft{box-shadow:var(--shadow-sm)}
.card.header{ padding:0; overflow:hidden }
.card.header .card-head{
  padding:.9rem 1rem;
  border-bottom:1px solid var(--theme-border);
  font-weight:700;
}
.card.header .card-body{ padding:1rem }
.card:hover{ transform:translateY(-2px); box-shadow:var(--elev-hover) }

.card-grid{
  display:grid; gap:var(--gap-3);
  grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));
  grid-auto-rows:1fr;
}

.tiles{
  display:grid; gap:var(--gap-3);
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}
.tile{
  display:grid; place-items:center; text-align:center;
  min-height:120px; padding:18px; border-radius:var(--radius);
  border:1px solid var(--theme-border); background:var(--theme-card);
  box-shadow:var(--shadow-md);
  transition:transform .08s ease, box-shadow .12s ease, filter .2s ease;
}
.tile:hover{ transform:translateY(-2px); box-shadow:0 12px 26px rgba(20,30,55,.14) }
.tile i{ font-size:22px; opacity:.9; margin-bottom:8px; transition: transform .2s ease, opacity .2s linear }
.tile:hover i{ transform:scale(1.06); opacity:1 }

/* KPI */
.kpi{
  display:flex; align-items:center; justify-content:space-between;
  gap:var(--gap-2); padding:1rem;
  border-radius:var(--radius-sm);
  background:linear-gradient(135deg,
    color-mix(in oklab, var(--theme-brand) 22%, var(--theme-card)) 0%,
    color-mix(in oklab, var(--theme-brand-2) 16%, var(--theme-card)) 100%);
  border:1px solid color-mix(in oklab, var(--theme-brand) 30%, var(--theme-border));
  box-shadow:0 10px 25px color-mix(in oklab, var(--theme-brand) 18%, transparent);
}
.kpi .label{font-size:.9rem; color:var(--theme-fg-muted)}
.kpi .value{font-size:1.6rem; font-weight:800}
.kpi .delta{font-size:.85rem; font-weight:800; padding:.15rem .5rem; border-radius:999px}
.kpi .delta.up{
  color:var(--success);
  background:color-mix(in oklab, var(--success) 16%, transparent);
  border:1px solid color-mix(in oklab, var(--success) 36%, transparent);
}
.kpi .delta.down{
  color:var(--danger);
  background:color-mix(in oklab, var(--danger) 16%, transparent);
  border:1px solid color-mix(in oklab, var(--danger) 36%, transparent);
}

/* ==========================================================================
   CONTROLS (Buttons / Inputs / Toolbars)
   ========================================================================== */
.btn{
  appearance:none; border:1px solid transparent;
  border-radius:999px; padding:.55rem .95rem;
  font-weight:600; cursor:pointer; line-height:1;
  background:var(--theme-card); color:var(--theme-fg); border-color:var(--theme-border);
  transition:transform .12s ease, box-shadow .15s ease, filter .2s ease;
  height:var(--control-h);
}
.btn:hover{ filter:brightness(1.05); transform:translateY(-1px) scale(1.01) }
.btn:active{ transform:translateY(0) scale(0.995) }
.btn:focus{ outline:none; box-shadow:var(--ring-brand) }

/* Primary CTA — ALWAYS brand blue */
.btn.primary{
  background:linear-gradient(180deg, var(--theme-brand-2), var(--theme-brand));
  color:#fff; border-color:transparent;
  box-shadow:0 8px 24px color-mix(in oklab, var(--theme-brand) 30%, transparent);
}

/* Glass/“grassmorphic” call-to-action for dashboards & stocklist */
.btn.grass{
  background:
    radial-gradient(120% 120% at 10% 10%, rgba(255,255,255,.25) 0%, transparent 50%),
    linear-gradient(180deg, var(--theme-brand-2), var(--theme-brand));
  color:#fff; border:0;
  box-shadow: 0 10px 24px color-mix(in oklab, var(--theme-brand) 32%, transparent),
              inset 0 0 0 1px rgba(255,255,255,.18);
}

.btn.ghost{background:transparent; border-color:var(--theme-border)}
.btn.muted{background:var(--theme-surface)}
.btn.icon{padding:.45rem .6rem; display:inline-flex; align-items:center; gap:.4rem; height:var(--control-h)}
.btn[disabled], .btn.disabled{ opacity:.6; pointer-events:none; filter:none; transform:none }
.btn-group-sm .btn{ height:36px; padding:.4rem .7rem; border-radius:10px }

/* Badges / Chips */
.chip{
  display:inline-flex; align-items:center; gap:.4rem;
  padding:.25rem .6rem; border-radius:999px; font-size:.8rem;
  border:1px solid var(--theme-border); background:var(--theme-surface); color:var(--theme-fg);
}
.chip .dot{width:.5rem; height:.5rem; border-radius:50%}
.chip.red{color:#fff; background:var(--danger); border-color:transparent}
.chip.green{color:#fff; background:var(--success); border-color:transparent}

/* Inputs */
.input, select, textarea{
  width:100%; padding:.65rem .8rem; border-radius:12px;
  background:var(--theme-card); color:var(--theme-fg);
  border:1px solid var(--theme-border); outline:none; height:var(--control-h);
}
.input:focus, select:focus, textarea:focus{
  border-color:color-mix(in oklab, var(--theme-brand) 60%, var(--theme-border));
  box-shadow:0 0 0 3px color-mix(in oklab, var(--theme-brand) 30%, transparent);
  background:var(--theme-card);
}

/* Bootstrap bridge */
.form-control, .form-select{
  background:var(--theme-card); border-color:var(--theme-border); color:var(--theme-fg); height:var(--control-h);
}
.form-control:focus, .form-select:focus{
  border-color:color-mix(in oklab, var(--theme-brand) 60%, var(--theme-border));
  box-shadow:0 0 0 3px color-mix(in oklab, var(--theme-brand) 30%, transparent);
}

/* Uniform toolbar heights */
.toolbar{ display:flex; flex-wrap:wrap; gap:.5rem; align-items:center }
.toolbar .form-control, .toolbar .form-select, .toolbar .btn{ height:var(--control-h) }

/* Settings rows */
.form-row{
  display:grid; gap:10px;
  grid-template-columns:minmax(140px, 1fr) 2.5fr;
  align-items:center;
}
@media (max-width:576px){ .form-row{ grid-template-columns:1fr } }

/* Switch */
.switch{ position:relative; display:inline-block; width:44px; height:24px }
.switch input{opacity:0; width:0; height:0}
.switch .slider{
  position:absolute; cursor:pointer; inset:0; background:var(--theme-surface);
  border:1px solid var(--theme-border); border-radius:999px; transition:.2s ease;
}
.switch .slider::before{
  content:""; position:absolute; height:18px; width:18px; left:2px; top:2px;
  background:#fff; border-radius:50%; transition:.2s ease; box-shadow:var(--shadow-sm);
}
.switch input:checked + .slider{ background:color-mix(in oklab, var(--theme-brand) 35%, var(--theme-surface)) }
.switch input:checked + .slider::before{ transform:translateX(20px) }

/* ==========================================================================
   TABLES
   ========================================================================== */
.table{
  width:100%; border-collapse:separate; border-spacing:0; font-size:.95rem;
  background:var(--theme-card); border:1px solid var(--theme-border); border-radius:var(--radius);
  overflow:hidden; box-shadow:var(--shadow-sm);
}
.table thead th{
  text-align:left; padding:.75rem .9rem; background:var(--theme-surface);
  color:var(--theme-fg-muted); border-bottom:1px solid var(--theme-border);
  white-space:nowrap; cursor:pointer;
}
.table thead th.sortable::after{ content:' ↕'; opacity:.35; font-weight:normal }
.table tbody td{ padding:.75rem .9rem; border-bottom:1px solid var(--theme-border) }
.table tbody tr:hover{ background:color-mix(in oklab, var(--theme-brand) 6%, transparent) }

.table-compact thead th, .table-compact tbody td{ padding:.55rem .7rem }
.table.sticky thead th{ position:sticky; top:0; z-index:2 }
.table-actions{ width:112px }
.cell-ellipsis{ max-width:280px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
.section-tight > .table, .section-tight .card.header{ margin-top:.25rem }

/* ==========================================================================
   ALERTS / TOASTS
   ========================================================================== */
.alert{
  padding:.85rem 1rem; border-radius:12px; border:1px solid var(--theme-border);
  background:var(--theme-surface); color:var(--theme-fg);
}
.alert.success{ border-color:color-mix(in oklab, var(--success) 40%, var(--theme-border)); background:color-mix(in oklab, var(--success) 12%, transparent) }
.alert.warn{    border-color:color-mix(in oklab, var(--warning) 40%, var(--theme-border)); background:color-mix(in oklab, var(--warning) 12%, transparent) }
.alert.danger{  border-color:color-mix(in oklab, var(--danger) 40%,  var(--theme-border)); background:color-mix(in oklab, var(--danger) 12%, transparent) }
.toast{ border-radius:12px; padding:.7rem .9rem; box-shadow:var(--shadow-md); background:var(--theme-card); border:1px solid var(--theme-border) }

/* ==========================================================================
   CHARTS (uniform heights) + Reveal
   ========================================================================== */
.chart-box{ height:var(--chart-h); padding:12px }
.chart-box--sm{ height:var(--chart-h-sm) }
.chart-canvas{ width:100% !important; max-width:100%; height:var(--chart-h) !important }
.chart-canvas--sm{ height:var(--chart-h-sm) !important }
.chart-grid{ stroke: var(--chart-grid) }
@media (max-width:992px){
  .chart-box{ height:220px }
  .chart-canvas{ height:220px !important }
}
.reveal{ opacity:0; transform:translateY(8px) }
.reveal.in{ opacity:1; transform:translateY(0); transition:opacity .5s ease, transform .5s ease }

/* ==========================================================================
   SKELETON LOADERS
   ========================================================================== */
@keyframes shimmer{ 0%{background-position:-450px 0} 100%{background-position:450px 0} }
.skeleton{
  position:relative; overflow:hidden; border-radius:8px;
  background:linear-gradient(90deg, rgba(255,255,255,.06) 25%, rgba(255,255,255,.12) 37%, rgba(255,255,255,.06) 63%);
  background-size:900px 100%;
  animation:shimmer 1.25s infinite linear; min-height:12px;
}
.skeleton.sm{ height:12px } .skeleton.md{ height:18px } .skeleton.lg{ height:28px }
.skeleton.round{ border-radius:999px }
.skeleton-card{ border:1px solid var(--theme-border); background:var(--theme-card); border-radius:var(--radius); padding:var(--card-pad) }
.is-loading .hide-while-loading{ opacity:0; pointer-events:none } .is-loading .show-while-loading{ display:block }
.show-while-loading{ display:none }
.skel-kpi{ display:flex; align-items:center; gap:12px }
.skel-kpi .icon{ width:42px; height:42px; border-radius:12px }
.skel-kpi .lines{ flex:1 1 auto }
.skel-chart{ height:var(--chart-h); border-radius:10px; border:1px dashed var(--theme-border) }

/* ==========================================================================
   AI INSIGHTS
   ========================================================================== */
.ai-card{
  border:1px solid var(--theme-border); background:var(--theme-card);
  border-radius:12px; padding:12px; box-shadow:var(--shadow-sm);
}
.ai-card + .ai-card{ margin-top:.5rem }
.ai-risk{
  border-color: color-mix(in oklab, var(--danger) 45%, var(--theme-border));
  background: linear-gradient(0deg, color-mix(in oklab, var(--danger) 10%, transparent), transparent), var(--theme-card);
  box-shadow: 0 10px 28px color-mix(in oklab, var(--danger) 24%, transparent);
}
.ai-safe{
  border-color: color-mix(in oklab, var(--success) 45%, var(--theme-border));
  background: linear-gradient(0deg, color-mix(in oklab, var(--success) 10%, transparent), transparent), var(--theme-card);
  box-shadow: 0 10px 28px color-mix(in oklab, var(--success) 20%, transparent);
}

/* ==========================================================================
   PROGRESS / BATTERY
   ========================================================================== */
.battery-wrap{ position:relative; width:90px }
.battery{
  height:180px; width:90px; border:2px solid #334155; border-radius:16px;
  position:relative; overflow:hidden; background:var(--theme-surface);
  box-shadow:inset 0 0 8px rgba(0,0,0,.08);
}
.battery-cap{
  position:absolute; top:-12px; left:50%; transform:translateX(-50%);
  width:36px; height:10px; border:2px solid #334155; border-bottom:none;
  border-radius:8px 8px 0 0; background:var(--theme-surface);
}
.battery-fill{ position:absolute; bottom:0; left:0; right:0; height:0%; transition:height .6s ease, background-color .25s ease }
.fill-red{ background:#ef4444 } .fill-yellow{ background:#f59e0b }
.fill-mildgreen{ background:#22c55e } .fill-lightgreen{ background:#86efac }

/* ==========================================================================
   HEATMAP
   ========================================================================== */
.heatmap{ width:100%; overflow-x:auto }
.heatmap-grid{ display:block }
.heatmap-row{ display:grid; grid-template-columns:180px repeat(12, minmax(36px, 1fr)); gap:6px; margin-bottom:6px }
.heatmap-header{ position:sticky; top:0; padding-top:2px; background:color-mix(in oklab, var(--theme-card) 92%, transparent); z-index:1 }
.heatmap-cell{
  background:var(--theme-card); border:1px solid var(--theme-border); border-radius:8px;
  min-height:32px; display:flex; align-items:center; justify-content:center;
  color:var(--theme-fg); font-size:.85rem; box-shadow:0 6px 18px rgba(16,24,40,.04);
}
.heatmap-corner{ background:transparent; border-color:transparent; box-shadow:none }
.heatmap-label{ justify-content:flex-start; padding:0 .5rem; font-weight:700; white-space:nowrap }
.heatmap-week{ font-weight:700; color:var(--theme-fg-muted) }
.heatmap-val{
  background:
    linear-gradient(180deg,
      color-mix(in oklab, var(--theme-brand) calc(var(--heat, 0) * 70%), transparent) 0%,
      color-mix(in oklab, var(--theme-brand-2) calc(var(--heat, 0) * 65%), transparent) 100%);
  border-color: color-mix(in oklab, var(--theme-brand) calc(var(--heat, 0) * 40%), var(--theme-border));
}
@media (max-width:992px){
  .heatmap-row{ grid-template-columns:150px repeat(8, minmax(30px, 1fr)) }
}

/* ==========================================================================
   ANIMATIONS & HELPERS
   ========================================================================== */
.will-animate{ transform:translateY(8px); opacity:0 }
.will-animate.in{ transform:translateY(0); opacity:1; transition:transform .5s ease, opacity .5s ease }
.round{border-radius:var(--radius)} .round-sm{border-radius:var(--radius-sm)}
.shadow{box-shadow:var(--shadow-md)} .soft{box-shadow:var(--shadow-sm)}
.hidden{display:none !important}
.center{display:flex; align-items:center; justify-content:center}
.glow-hover{ transition: box-shadow .18s ease, transform .12s ease }
.glow-hover:hover{ transform: translateY(-2px); box-shadow: var(--elev-hover) }

/* ==========================================================================
   ICON STANDARDIZATION (green icons globally)
   ========================================================================== */
.bi, .icon, svg.icon { color: var(--icon-green) !important; fill: currentColor; stroke: currentColor; }
.icon-default { color: inherit !important; } /* opt-out */
