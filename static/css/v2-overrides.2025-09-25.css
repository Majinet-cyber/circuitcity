/* ==========================================================================
   v2-overrides.css — local dev overrides for Circuit City
   Safe to keep in repo; tweak styles without touching vendor CSS.
   --------------------------------------------------------------------------
   Notes:
   - Designed to be harmless if classes aren’t present.
   - Light Bootstrap-leaning defaults; works even without Bootstrap loaded.
   - Keep selectors specific but not too heavy to avoid cascade wars.
   ========================================================================== */

/* --------------------------------------------------------------------------
   CSS Variables (theme tokens)
   -------------------------------------------------------------------------- */
:root {
  --cc-dev: 1;

  /* Brand */
  --cc-brand: #0d6efd;           /* primary */
  --cc-brand-600: #0b5ed7;
  --cc-accent: #20c997;          /* teal-ish success accent */
  --cc-warning: #f59f00;
  --cc-danger: #e03131;

  /* Grays */
  --cc-bg: #f7f8fb;
  --cc-card: #ffffff;
  --cc-muted: #6c757d;
  --cc-border: #e5e7eb;
  --cc-heading: #111827;
  --cc-text: #1f2937;

  /* Surfaces */
  --cc-shadow-sm: 0 1px 2px rgb(0 0 0 / 6%);
  --cc-shadow-md: 0 8px 24px rgb(0 0 0 / 10%);

  /* Radius & spacing */
  --cc-radius: 14px;
  --cc-radius-sm: 10px;
  --cc-gap: 14px;

  /* Charts */
  --cc-chart-1: #4f46e5;
  --cc-chart-2: #06b6d4;
  --cc-chart-3: #22c55e;
  --cc-chart-4: #f59e0b;

  /* Table */
  --cc-row-hover: #f3f4f6;

  /* ===== Mobile nav & safe-area tokens (additive) ===== */
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: max(env(safe-area-inset-bottom), 0px);
  --dock-h: 64px; /* height of the mobile bottom dock/tabbar */
}

/* Dark mode (opt-in via body.dark or prefers-color-scheme) */
@media (prefers-color-scheme: dark) {
  :root {
    --cc-bg: #0f1115;
    --cc-card: #171a21;
    --cc-text: #e5e7eb;
    --cc-heading: #f8fafc;
    --cc-border: #242936;
    --cc-row-hover: #1b1f2a;
    --cc-shadow-sm: 0 1px 2px rgb(0 0 0 / 40%);
    --cc-shadow-md: 0 8px 24px rgb(0 0 0 / 50%);
  }
}
body.dark {
  --cc-bg: #0f1115;
  --cc-card: #171a21;
  --cc-text: #e5e7eb;
  --cc-heading: #f8fafc;
  --cc-border: #242936;
  --cc-row-hover: #1b1f2a;
}

/* --------------------------------------------------------------------------
   Base layout polish
   -------------------------------------------------------------------------- */
html, body {
  background: var(--cc-bg);
  color: var(--cc-text);
  max-width: 100%;
  overflow-x: hidden; /* prevent horizontal scroll on small screens */
  -webkit-text-size-adjust: 100%;
}

/* Stop iOS zoom-on-focus (inputs <16px trigger zoom) */
input, select, textarea { font-size: 16px; }

h1, h2, h3, h4, h5 {
  color: var(--cc-heading);
  letter-spacing: -0.01em;
}

/* Fluid downscale on very small handsets to avoid “zoom out” screenshots */
@media (max-width: 420px){
  h1 { font-size: clamp(20px, 6vw, 24px); line-height: 1.2; }
  h2 { font-size: clamp(18px, 5.2vw, 22px); line-height: 1.25; }
  .display-1, .display-2, .display-3 { font-size: clamp(24px, 7vw, 30px); line-height: 1.15; }
}

/* Universal media guard so wide media doesn’t push layout sideways */
img, svg, video, canvas { max-width: 100%; height: auto; }

/* Ensure page content never sits under the mobile dock/tabbar */
main, .cc-page, .content, .page, .container, .container-fluid {
  padding-bottom: calc(var(--dock-h) + var(--safe-bottom) + 16px);
}

.container, .container-fluid {
  padding-left: max(12px, 3vw);
  padding-right: max(12px, 3vw);
}

/* Reduce overly large gaps on dashboards */
.section,
.section-sm {
  margin-block: calc(var(--cc-gap) * 1.2);
}

/* Cards */
.card,
.cc-card,
.stat-card {
  background: var(--cc-card);
  border: 1px solid var(--cc-border);
  border-radius: var(--cc-radius);
  box-shadow: var(--cc-shadow-sm);
}

.card:hover,
.cc-card:hover,
.stat-card:hover {
  box-shadow: var(--cc-shadow-md);
  transition: box-shadow .18s ease;
}

.card-header {
  background: transparent;
  border-bottom: 1px solid var(--cc-border);
  font-weight: 600;
}

/* KPI chips */
.kpi,
.kpi-chip {
  display: inline-flex;
  align-items: baseline;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 999px;
  background: var(--cc-row-hover);
  border: 1px solid var(--cc-border);
  font-variation-settings: "wght" 580;
}

/* --------------------------------------------------------------------------
   Buttons (Bootstrap-like without requiring it)
   -------------------------------------------------------------------------- */
.btn, .button, .cc-btn {
  --_bg: var(--cc-brand);
  --_bg-hover: var(--cc-brand-600);
  --_text: #fff;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  font-weight: 600;
  border-radius: 12px;
  border: 1px solid transparent;
  background: var(--_bg);
  color: var(--_text);
  text-decoration: none;
  cursor: pointer;
}
.btn:hover, .button:hover, .cc-btn:hover { background: var(--_bg-hover); }

.btn-outline, .btn-outline-primary {
  --_bg: transparent;
  --_text: var(--cc-brand);
  border-color: var(--cc-brand);
  background: transparent;
  color: var(--_text);
}
.btn-outline:hover, .btn-outline-primary:hover {
  background: color-mix(in srgb, var(--cc-brand) 10%, transparent);
}

/* Utility tints */
.badge-success, .pill-success { background: color-mix(in srgb, var(--cc-accent) 18%, #fff); color: #0f5132; border: 1px solid color-mix(in srgb, var(--cc-accent) 30%, #0000); }
.badge-warning, .pill-warning { background: color-mix(in srgb, var(--cc-warning) 18%, #fff); color: #7a4d00; border: 1px solid color-mix(in srgb, var(--cc-warning) 30%, #0000); }
.badge-danger,  .pill-danger  { background: color-mix(in srgb, var(--cc-danger) 18%, #fff);  color: #6b1010; border: 1px solid color-mix(in srgb, var(--cc-danger) 30%, #0000); }

/* --------------------------------------------------------------------------
   Tables
   -------------------------------------------------------------------------- */
.table, table.cc-table {
  width: 100%;
  background: var(--cc-card);
  border: 1px solid var(--cc-border);
  border-radius: var(--cc-radius);
  overflow: hidden;
  border-collapse: separate;
  border-spacing: 0;
}

.table thead th, table.cc-table thead th {
  background: var(--cc-row-hover);
  color: var(--cc-heading);
  font-weight: 700;
  border-bottom: 1px solid var(--cc-border);
}

.table tbody tr:hover,
table.cc-table tbody tr:hover {
  background: var(--cc-row-hover);
}

.table th, .table td,
table.cc-table th, table.cc-table td {
  padding: 10px 12px;
  border-bottom: 1px solid var(--cc-border);
  vertical-align: middle;
  white-space: nowrap;        /* keep numeric columns tidy */
}

.table td.text-wrap, table.cc-table td.text-wrap { white-space: normal; }

/* Responsive table wrapper */
.table-responsive {
  overflow: auto;
  border: 1px solid var(--cc-border);
  border-radius: var(--cc-radius);
}

/* --------------------------------------------------------------------------
   Forms
   -------------------------------------------------------------------------- */
input[type="text"], input[type="number"], input[type="email"], input[type="password"],
select, textarea, .form-control {
  background: var(--cc-card);
  border: 1px solid var(--cc-border);
  border-radius: 12px;
  padding: 10px 12px;
  color: var(--cc-text);
}

input:focus, select:focus, textarea:focus, .form-control:focus {
  outline: none;
  border-color: color-mix(in srgb, var(--cc-brand) 60%, var(--cc-border));
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--cc-brand) 15%, transparent);
  transition: box-shadow .18s ease, border-color .18s ease;
}

/* Fix select2 / datepicker overlapping modals if used */
.select2-container, .flatpickr-calendar, .datepicker {
  z-index: 2000 !important;
}

/* --------------------------------------------------------------------------
   Dashboard-specific helpers (safe if unused)
   -------------------------------------------------------------------------- */
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: var(--cc-gap);
}

.stat-card .stat-value {
  font-size: clamp(22px, 3.2vw, 32px);
  font-weight: 800;
  letter-spacing: -0.02em;
}
.stat-card .stat-label {
  color: var(--cc-muted);
  font-weight: 500;
}

/* Simple progress bar */
.cc-progress {
  height: 8px;
  background: var(--cc-border);
  border-radius: 999px;
  overflow: hidden;
}
.cc-progress > span {
  display: block;
  height: 100%;
  width: var(--value, 0%);
  background: var(--cc-brand);
  border-radius: inherit;
}

/* --------------------------------------------------------------------------
   Charts (generic containers)
   -------------------------------------------------------------------------- */
.chart-card canvas, .chart, .rechart, .apexchart {
  width: 100%;
  height: 280px;
}

/* --------------------------------------------------------------------------
   Navbar / Sidebar (if present)
   -------------------------------------------------------------------------- */
.navbar, .app-navbar {
  background: var(--cc-card);
  border-bottom: 1px solid var(--cc-border);
  backdrop-filter: saturate(1.2) blur(6px);
}
.sidebar, .app-sidebar {
  background: var(--cc-card);
  border-right: 1px solid var(--cc-border);
}

/* --------------------------------------------------------------------------
   Toasts / Alerts
   -------------------------------------------------------------------------- */
.alert {
  border: 1px solid var(--cc-border);
  border-radius: 12px;
  box-shadow: var(--cc-shadow-sm);
}
.alert-success { border-color: color-mix(in srgb, var(--cc-accent) 45%, var(--cc-border)); }
.alert-warning { border-color: color-mix(in srgb, var(--cc-warning) 45%, var(--cc-border)); }
.alert-danger  { border-color: color-mix(in srgb, var(--cc-danger)  45%, var(--cc-border)); }

/* --------------------------------------------------------------------------
   Misc utilities
   -------------------------------------------------------------------------- */
.text-muted { color: var(--cc-muted) !important; }
.border     { border: 1px solid var(--cc-border) !important; border-radius: 12px; }
.shadow-sm  { box-shadow: var(--cc-shadow-sm) !important; }
.shadow-md  { box-shadow: var(--cc-shadow-md) !important; }
.rounded    { border-radius: var(--cc-radius) !important; }
.rounded-sm { border-radius: var(--cc-radius-sm) !important; }

.gap-cc     { gap: var(--cc-gap); }
.p-cc       { padding: var(--cc-gap); }
.py-cc      { padding-block: var(--cc-gap); }
.px-cc      { padding-inline: var(--cc-gap); }

/* ===== Mobile-only helpers ===== */

/* Keep floating Scan FAB above the mobile dock if present */
@media (max-width: 991.98px){
  .scan-fab { bottom: calc(var(--dock-h) + var(--safe-bottom) + 16px) !important; }
}

/* Make long words/IMEIs wrap gracefully on narrow widths */
.break-words, .wrap-anywhere { overflow-wrap: anywhere; word-break: break-word; }

/* --------------------------------------------------------------------------
   Print (hide chrome, keep table borders)
   -------------------------------------------------------------------------- */
@media print {
  .navbar, .sidebar, .btn, .cc-btn, .no-print { display: none !important; }
  body { background: #fff; color: #000; }
  .card, .table, .cc-card { box-shadow: none; border-color: #bbb; }
}

/* --------------------------------------------------------------------------
   🔧 Anti-blur footer fix (prevents the “blurry footer” overlay)
   -------------------------------------------------------------------------- */
.footer-blur,
.glass-footer,
.bottom-blur,
.mobile-fab-bar,
.sticky-bottom,
.cc-sticky-bar,
.cc-bottom-blur,
.sticky-cta,
.sticky-actions,
.tabbar,
.fab-bar {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  filter: none !important;
  box-shadow: none !important;
  background: var(--cc-card) !important;
  border-top: 1px solid var(--cc-border) !important;
  opacity: 1 !important;
}

/* ========================================================================== */
/*                           🔧 MOBILE RESCUE PATCHES                         */
/* ========================================================================== */

/* 1) Drawer/HUD layering so taps hit the right thing */
.cc-sidebar{ z-index: 2000 !important; }
.cc-backdrop{
  z-index: 1990 !important;
  pointer-events: none;
  opacity: 0;
  transition: opacity .2s ease;
}
.cc-backdrop.show{ pointer-events: auto; opacity: 1; }
.mobile-toggle{ z-index: 2010 !important; }
.tenant-menu{ z-index: 2050 !important; pointer-events: auto; }
.cc-header{ z-index: 1900 !important; }

/* Make the tenant pill feel tappable on mobile */
.tenant-pill{
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  user-select: none;
}

/* Keep the bottom dock below popovers/menus but above content */
.mobile-tabbar,
.cc-bottom-nav{ z-index: 1200 !important; }

/* 2) Mobile full-width & orderly layout */
@media (max-width: 991.98px){
  html, body { overflow-x: hidden; }

  .cc-page,
  main.cc-page,
  .container,
  .container-fluid {
    max-width: 100% !important;
    width: 100% !important;
    padding-left: 12px !important;
    padding-right: 12px !important;
  }

  .row { margin-left: 0 !important; margin-right: 0 !important; }
  [class*="col-"] { padding-left: 8px !important; padding-right: 8px !important; }

  /* Force multi-column dashboards into a single column on phones */
  .grid-2, .grid, .dashboard-grid,
  .two-col, .layout-2col, .content-grid, .columns {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 12px !important;
  }

  /* Defensive: wide media/tables never push layout */
  img, svg, video, canvas, table { max-width: 100% !important; height: auto !important; }
  .table-responsive { width: 100% !important; overflow-x: auto; -webkit-overflow-scrolling: touch; }

  /* Inventory/scan main panels fill the width */
  .scan-page, .scan, .inventory-panel, .content-panel {
    width: 100% !important;
    max-width: 100% !important;
  }
}

/* 3) Hide narrow “intro/help” left rail text on phones (the tall copy beside IMEI) */
@media (max-width: 768px){
  .help-rail, .helper-rail, .explain-rail, .side-rail,
  .intro-rail, .blurb-rail, .left-rail, aside.aside, aside.left {
    display: none !important;
  }
}

/* 4) Header/title safety so it doesn’t overlap the tenant chip/bell */
@media (max-width: 991.98px){
  .page-header, .header, .cc-header, .page-title, .title-bar {
    position: relative !important;
    display: flex !important;
    align-items: center !important;
    flex-wrap: wrap !important;
    gap: .5rem !important;
    margin: 0 0 12px !important;
  }
  .page-title h1, .page-title h2, .title, h1.page-title, .header .title {
    position: static !important;
    transform: none !important;
    margin: 0 !important;
    min-width: 0 !important;
    font-size: clamp(1.125rem, 4.2vw, 1.5rem) !important;
    line-height: 1.2 !important;
  }
  /* Any decorative hero/title card should not float over content */
  .hero, .title-card, .stat-hero {
    position: static !important;
    transform: none !important;
    margin: 0 0 12px !important;
  }
}

/* 5) Kill any horizontal scroll containers that force the page wider */
@media (max-width: 991.98px){
  .scroll-x, .overflow-x, .h-scroll {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    max-width: 100% !important;
  }
}

/* 6) Respect notches/safe areas so headers/docks don’t tuck underneath */
@supports (padding: max(0px)) {
  .navbar, .topbar, header, .page-header { padding-top: max(0px, var(--safe-top)); }
  .bottom-nav, .tabbar, .cc-bottom-nav { padding-bottom: max(8px, var(--safe-bottom)); }
}

/* 7) Extra guard: any element with inline width/min-width won’t break mobile */
@media (max-width: 991.98px){
  [style*="width:"], [style*="min-width:"], [style*="max-width:"] {
    max-width: 100% !important;
  }
}


/* ===== Mobile warp rescue ===== */
@media (max-width: 991.98px) {
  /* Hide the tall helper rail text on small screens */
  .help-rail,
  .helper-rail,
  .explain-rail,
  .side-rail,
  .intro-rail,
  .blurb-rail,
  .left-rail,
  aside.aside,
  aside.left {
    display: none !important;
  }

  /* Force inventory/scan panels to full width */
  .scan-page,
  .scan,
  .inventory-panel,
  .content-panel {
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Stack grids into one column */
  .grid,
  .grid-2,
  .dashboard-grid,
  .two-col,
  .layout-2col,
  .content-grid,
  .columns {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 12px !important;
  }
}
