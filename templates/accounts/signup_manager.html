{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Create your store · Circuit City</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" href="{% static 'favicon.ico' %}">
  <style>
    :root{
      --bg: #f5f7fb;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#6b7280;
      --primary:#2563eb;
      --primary-600:#1d4ed8;
      --ring:#bfdbfe;
      --error:#dc2626;
      --success:#16a34a;
      --radius:16px;
      --shadow: 0 10px 24px rgba(2,6,23,.08), 0 2px 6px rgba(2,6,23,.06);
      --input: 1px solid #dbe2f1;
      --input-focus: 2px solid var(--ring);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial;
      color:var(--ink); background:
        radial-gradient(1200px 600px at 80% -10%, #e8f0ff 0%, transparent 60%),
        radial-gradient(1000px 500px at -10% 110%, #e8f0ff 0%, transparent 60%),
        var(--bg);
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      width: min(1040px, 92%); margin: 26px auto 0;
      color:#0b1220; font-weight:800; letter-spacing:.2px;
    }
    .brand img{width:28px;height:28px}
    .shell{
      width:min(1040px, 92%); margin: 18px auto 56px;
      background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
      padding: 32px clamp(18px, 3vw, 40px);
      animation: pop .35s ease-out;
    }
    @keyframes pop{
      from{transform:translateY(8px) scale(.98); opacity:0}
      to{transform:none; opacity:1}
    }
    h1{
      margin:.2rem 0 1.2rem; font-size: clamp(26px, 2.6vw, 38px);
      line-height:1.1; letter-spacing:-.02em;
    }
    .subtitle{color:var(--muted); font-size:.92rem; margin-top:-10px; margin-bottom:18px}
    form{display:grid; grid-template-columns: 1fr; gap:16px}
    @media (min-width:900px){
      form{grid-template-columns: 1fr 1fr}
    }
    .field{display:flex; flex-direction:column; gap:8px}
    .label{font-size:.9rem}
    .input{
      display:flex; align-items:center; gap:10px;
      border:var(--input); border-radius:12px; padding:12px 14px; background:#fff;
      transition:border .15s, box-shadow .15s, background .15s;
    }
    .input:focus-within{border:var(--input-focus); box-shadow:0 0 0 2px rgba(191,219,254,.3)}
    .input input{
      border:0; outline:0; width:100%; font-size:1rem; background:transparent; color:var(--ink);
    }
    .hint{color:var(--muted); font-size:.85rem; margin-top:-4px}
    .error{color:var(--error); font-size:.85rem; margin-top:4px}
    .row-span-2{grid-column: 1 / -1}
    .pw-toggle{cursor:pointer; border:0; background:transparent; padding:0 2px}
    .actions{
      display:flex; align-items:center; gap:16px; margin-top:8px; flex-wrap:wrap;
      grid-column: 1 / -1;
    }
    .btn{
      appearance:none; border:0; cursor:pointer;
      background: linear-gradient(180deg, var(--primary), var(--primary-600));
      color:#fff; font-weight:700;
      padding: 12px 18px; border-radius:12px; min-width:180px;
      box-shadow: 0 8px 20px rgba(37,99,235,.25);
      transition: transform .06s ease, box-shadow .2s ease, opacity .15s;
    }
    .btn:hover{transform:translateY(-1px); box-shadow: 0 10px 24px rgba(37,99,235,.28)}
    .btn:active{transform:translateY(0); box-shadow: 0 6px 14px rgba(37,99,235,.22)}
    .ghost{background:#f1f5ff; color:#1e3a8a}
    .link{color:var(--primary); text-decoration:none; font-weight:600}
    .messages{margin-bottom:8px; grid-column:1 / -1}
    .msg{
      padding:10px 12px; border-radius:10px; font-size:.92rem; margin:6px 0;
      border:1px solid #e5e7eb;
    }
    .msg.success{background:#ecfdf5; border-color:#86efac; color:#065f46}
    .msg.error{background:#fef2f2; border-color:#fecaca; color:#7f1d1d}
    .msg.info{background:#eff6ff; border-color:#bfdbfe; color:#0c4a6e}
    .grid-2{display:grid; grid-template-columns: 1fr 1fr; gap:16px}
    .sr{position:absolute;left:-10000px}
  </style>
</head>
<body>

  <!-- Brand (match login) -->
  <div class="brand">
    <img src="{% static 'img/logo-32.png' %}" alt="">
    <span>Circuit City</span>
  </div>

  <main class="shell" role="main" aria-labelledby="title">
    <h1 id="title">Create your store</h1>
    <p class="subtitle">Managers create the store and can invite agents later.</p>

    <form method="post" novalidate>
      {% csrf_token %}

      <!-- Django messages -->
      <div class="messages">
        {% if messages %}
          {% for m in messages %}
            <div class="msg {{ m.tags|default:'info' }}">{{ m }}</div>
          {% endfor %}
        {% endif %}
      </div>

      <!-- Email -->
      <div class="field">
        <label class="label" for="id_email">Email</label>
        <div class="input">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#64748b" d="M20 4H4a2 2 0 0 0-2 2v1.2l10 5.8l10-5.8V6a2 2 0 0 0-2-2Zm0 5.1L12 15L4 9.1V18a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9.1Z"/></svg>
          <input id="id_email" name="email" type="email" autocomplete="email"
                 value="{{ form.email.value|default_if_none:'' }}" required>
        </div>
        {% if form.email.errors %}<div class="error">{{ form.email.errors.0 }}</div>{% endif %}
      </div>

      <!-- Full name -->
      <div class="field">
        <label class="label" for="id_full_name">Your full name</label>
        <div class="input">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#64748b" d="M12 12a5 5 0 1 0-5-5a5 5 0 0 0 5 5Zm0 2c-4.418 0-8 2.239-8 5v1h16v-1c0-2.761-3.582-5-8-5Z"/></svg>
          <input id="id_full_name" name="full_name" type="text" autocomplete="name"
                 value="{{ form.full_name.value|default_if_none:'' }}" required>
        </div>
        {% if form.full_name.errors %}<div class="error">{{ form.full_name.errors.0 }}</div>{% endif %}
      </div>

      <!-- Store name -->
      <div class="field">
        <label class="label" for="id_business_name">Store name</label>
        <div class="input">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#64748b" d="M4 6h16v12H4zM2 4h20v2H2z"/></svg>
          <input id="id_business_name" name="business_name" type="text" autocomplete="organization"
                 value="{{ form.business_name.value|default_if_none:'' }}" required>
        </div>
        <div class="hint">This becomes your business name in the app.</div>
        {% if form.business_name.errors %}<div class="error">{{ form.business_name.errors.0 }}</div>{% endif %}
      </div>

      <!-- Subdomain -->
      <div class="field">
        <label class="label" for="id_subdomain">Subdomain (optional)</label>
        <div class="input">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#64748b" d="M11 3v7H4V3h7m2-2H2v11h11V1zM20 13v8h-8v-8h8m2-2h-12v12h12V11z"/></svg>
          <input id="id_subdomain" name="subdomain" type="text" placeholder="e.g. circuitcity"
                 value="{{ form.subdomain.value|default_if_none:'' }}">
        </div>
        {% if form.subdomain.errors %}<div class="error">{{ form.subdomain.errors.0 }}</div>{% endif %}
      </div>

      <!-- Password 1 -->
      <div class="field">
        <label class="label" for="id_password1">Password</label>
        <div class="input">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#64748b" d="M12 17a3 3 0 0 0 3-3V9a3 3 0 1 0-6 0v5a3 3 0 0 0 3 3Z"/></svg>
          <input id="id_password1" name="password1" type="password" autocomplete="new-password" required>
          <button class="pw-toggle" type="button" data-target="id_password1" aria-label="Show password">
            <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#64748b" d="M12 5c-7 0-10 7-10 7s3 7 10 7s10-7 10-7s-3-7-10-7Zm0 12a5 5 0 1 1 0-10a5 5 0 0 1 0 10Z"/></svg>
          </button>
        </div>
        {% if form.password1.errors %}<div class="error">{{ form.password1.errors.0 }}</div>{% endif %}
      </div>

      <!-- Password 2 -->
      <div class="field">
        <label class="label" for="id_password2">Confirm password</label>
        <div class="input">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="#64748b" d="M12 5a7 7 0 0 1 7 7v2h-2v-2a5 5 0 0 0-10 0v2H5v-2a7 7 0 0 1 7-7Z"/></svg>
          <input id="id_password2" name="password2" type="password" autocomplete="new-password" required>
          <button class="pw-toggle" type="button" data-target="id_password2" aria-label="Show password">
            <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#64748b" d="M12 5c-7 0-10 7-10 7s3 7 10 7s10-7 10-7s-3-7-10-7Zm0 12a5 5 0 1 1 0-10a5 5 0 0 1 0 10Z"/></svg>
          </button>
        </div>
        {% if form.password2.errors %}<div class="error">{{ form.password2.errors.0 }}</div>{% endif %}
      </div>

      <!-- Non-field errors -->
      {% if form.non_field_errors %}
        <div class="row-span-2 error">{{ form.non_field_errors.0 }}</div>
      {% endif %}

      <!-- Actions -->
      <div class="actions">
        <button class="btn" type="submit" id="submitBtn">
          Create my store
        </button>
        <span class="muted">Already have an account?
          <a class="link" href="{% url 'accounts:login' %}">Sign in</a>
        </span>
      </div>
    </form>
  </main>

  <script>
    // Password show/hide
    document.querySelectorAll('.pw-toggle').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('data-target');
        const el = document.getElementById(id);
        if(!el) return;
        el.type = (el.type === 'password') ? 'text' : 'password';
      })
    });

    // Prevent double submits
    const form = document.querySelector('form');
    const submitBtn = document.getElementById('submitBtn');
    form?.addEventListener('submit', ()=>{
      submitBtn.disabled = true;
      submitBtn.style.opacity = .7;
      submitBtn.textContent = 'Creating…';
    });
  </script>
</body>
</html>
