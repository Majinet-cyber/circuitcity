{% extends "base.html" %}
{% load humanize %}
{% block title %}Customer 路 {{ cust_name }}{% endblock %}
{% block header_title %}Customer 路 {{ cust_name }}{% endblock %}

{% block extra_css %}
<style>
  .wrap{ max-width:1024px; margin:0 auto; }
  .glass{ background:var(--cc-panel); border:1px solid var(--cc-border); border-radius:14px; box-shadow:var(--cc-shadow); }
  .head{ display:flex; align-items:center; gap:12px; padding:14px 16px; margin-bottom:12px; }
  .avatar{ width:44px; height:44px; border-radius:999px; background:var(--chip,#ddd); border:1px solid var(--cc-border); }
  .meta{ color:var(--cc-muted); font-weight:700; }
  table{ width:100%; border-collapse:collapse; }
  th,td{ padding:10px; border-bottom:1px solid var(--cc-border); text-align:left; }
  thead th{ font-weight:900; }
  .pill{ display:inline-block; padding:.2rem .55rem; border-radius:999px; border:1px solid var(--cc-border); font-weight:700; }
</style>
{% endblock %}

{% block content %}
<div class="wrap">
  <div class="glass head" style="--chip: {{ chip_color }}">
    <div class="avatar"></div>
    <div>
      <div class="fw-bold">{{ cust_name }}</div>
      {% if cust_phone %}<div class="meta">{{ cust_phone }}</div>{% endif %}
      <div class="meta">Total: {{ total|floatformat:2|intcomma }} 路 Paid: {{ paid|floatformat:2|intcomma }} 路 Owe: <strong>{{ balance|floatformat:2|intcomma }}</strong></div>
    </div>
  </div>

  <div class="glass">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Ref</th>
          <th>Product</th>
          <th>Status</th>
          <th>Paid</th>
          <th>Balance</th>
        </tr>
      </thead>
      <tbody>
        {% for o in orders %}
          <tr>
            <td>{{ o.id }}</td>
            <td><span class="pill">{{ o.ref }}</span></td>
            <td>{{ o.product }}{% if o.sku %} <span class="pill">{{ o.sku }}</span>{% endif %}</td>
            <td>{{ o.status }}</td>
            <td>{{ o.amount_paid|floatformat:2|intcomma }}</td>
            <td>{{ o.balance|floatformat:2|intcomma }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="6">No layby orders for this customer.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
